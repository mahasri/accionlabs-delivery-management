{% extends "base.html" %}

{% block content %}
{{ super() }}
{% endblock %}

{% block styles %}
{{ super() }}
<style>
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap');

/* Global font */
* {
    font-family: 'Roboto', sans-serif;
}

/* Main content area with margins */
.md-main__inner {
    margin-left: 2rem;
    margin-right: 2rem;
}

/* Left sidebar styling */
.md-nav--primary .md-nav__title {
    background-color: #3182ce;
    color: #ffffff;
    font-weight: 600;
    padding: 0.75rem 1rem;
    margin-bottom: 0.5rem;
    border-radius: 4px;
}

.md-nav--primary .md-nav__title:hover {
    background-color: #3182ce;
    color: #ffffff;
}

/* Main navigation items */
.md-nav--primary .md-nav__item .md-nav__link {
    font-weight: 500;
    color: #2d3748;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    margin-bottom: 0.25rem;
}

.md-nav--primary .md-nav__item .md-nav__link:hover {
    background-color: #e2e8f0;
    color: #2d3748;
}

/* Subsection titles - smaller font */
.md-nav--secondary .md-nav__title {
    font-size: 0.8rem;
    padding: 0.25rem 0.5rem;
    color: #4a5568;
}

/* Right sidebar styling - clean and simple */
.md-nav--secondary {
    background-color: #f7fafc;
    border-left: 1px solid #e2e8f0;
    padding: 1rem;
    border-radius: 4px;
}

.md-nav--secondary .md-nav__title {
    color: #2d3748;
    font-weight: 600;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #3182ce;
    font-size: 0.9rem; /* Smaller font size */
}

.md-nav--secondary .md-nav__item .md-nav__link {
    color: #4a5568;
    padding: 0.25rem 0;
    font-size: 0.8rem; /* Smaller font size to match left sidebar */
}

.md-nav--secondary .md-nav__item .md-nav__link:hover {
    color: #3182ce;
    background-color: transparent;
}

/* Active state for right sidebar links */
.md-nav--secondary .md-nav__item .md-nav__link[aria-current="true"],
.md-nav--secondary .md-nav__item .md-nav__link.active {
    color: #3182ce;
    font-weight: 600;
    background-color: #e6f3ff;
    border-radius: 4px;
    padding: 0.25rem 0.5rem;
}

/* Page header styling */
.md-header {
    background-color: #ffffff;
    border-bottom: 1px solid #e2e8f0;
}

.md-header__title {
    color: #2d3748;
    font-weight: 600;
}

/* Content styling */
.md-content {
    background-color: #ffffff;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* Headings */
.md-content h1 {
    color: #2d3748;
    border-bottom: 3px solid #3182ce;
    padding-bottom: 0.5rem;
    margin-bottom: 1.5rem;
}

.md-content h2 {
    color: #2d3748;
    border-bottom: 2px solid #e2e8f0;
    padding-bottom: 0.25rem;
    margin-top: 2rem;
    margin-bottom: 1rem;
}

.md-content h3 {
    color: #4a5568;
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
}

/* Code blocks */
.md-content pre {
    background-color: #f7fafc;
    border: 1px solid #e2e8f0;
    border-radius: 4px;
    padding: 1rem;
}

/* Tables */
.md-content table {
    border-collapse: collapse;
    width: 100%;
    margin: 1rem 0;
}

.md-content th {
    background-color: #3182ce;
    color: #ffffff;
    padding: 0.75rem;
    text-align: left;
}

.md-content td {
    padding: 0.75rem;
    border-bottom: 1px solid #e2e8f0;
}

.md-content tr:nth-child(even) {
    background-color: #f7fafc;
}

/* Images */
.md-content img {
    max-width: 100%;
    height: auto;
    border: 1px solid #e2e8f0;
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    margin: 1rem 0;
}

/* Blockquotes */
.md-content blockquote {
    border-left: 4px solid #3182ce;
    background-color: #f7fafc;
    padding: 1rem;
    margin: 1rem 0;
    border-radius: 0 4px 4px 0;
}

/* Navigation breadcrumbs */
.md-nav__path {
    background-color: #f7fafc;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    margin-bottom: 1rem;
}

/* Search styling */
.md-search__input {
    background-color: #f7fafc;
    border: 1px solid #e2e8f0;
    border-radius: 4px;
}

.md-search__input::placeholder {
    color: #a0aec0;
}

/* Responsive design */
@media (max-width: 768px) {
    .md-main__inner {
        margin-left: 1rem;
        margin-right: 1rem;
    }
    
    .md-content {
        padding: 1rem;
    }
}

/* Force light mode */
:root {
    color-scheme: light;
}

/* Hide dark mode toggle */
.md-toggle[data-md-toggle="palette"] {
    display: none !important;
}

/* Remove duplicate Home link - hide the first one */
.md-nav--primary .md-nav__item:first-child .md-nav__link[href="/"] {
    display: none !important;
}

/* Also hide the Home link in the main navigation if it appears twice */
.md-nav--primary .md-nav__item .md-nav__link[href="/"]:not(:first-child) {
    display: none !important;
}
</style>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
// Right sidebar auto-highlighting functionality
document.addEventListener('DOMContentLoaded', function() {
    // Wait a bit for the page to fully load
    setTimeout(function() {
        // Get all headings in the content
        const headings = document.querySelectorAll('.md-content h1, .md-content h2, .md-content h3, .md-content h4, .md-content h5, .md-content h6');
        const navLinks = document.querySelectorAll('.md-nav--secondary .md-nav__link');
        
        console.log('Found headings:', headings.length);
        console.log('Found nav links:', navLinks.length);
        
        // Create intersection observer to track which heading is in view
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    // Remove active class from all nav links
                    navLinks.forEach(link => {
                        link.classList.remove('active');
                    });
                    
                    // Add active class to corresponding nav link
                    const targetId = entry.target.id;
                    const correspondingLink = document.querySelector(`.md-nav--secondary .md-nav__link[href="#${targetId}"]`);
                    if (correspondingLink) {
                        correspondingLink.classList.add('active');
                        console.log('Highlighting:', targetId);
                    }
                }
            });
        }, {
            rootMargin: '-10% 0px -80% 0px', // Adjust these values to control when highlighting triggers
            threshold: 0
        });
        
        // Observe all headings
        headings.forEach(heading => {
            if (heading.id) {
                observer.observe(heading);
            }
        });
        
        // Also handle scroll events for better responsiveness
        let scrollTimeout;
        window.addEventListener('scroll', function() {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(function() {
                const scrollPosition = window.scrollY + 150; // Offset for header
                
                // Find the current section
                let currentSection = null;
                headings.forEach(heading => {
                    if (heading.offsetTop <= scrollPosition) {
                        currentSection = heading;
                    }
                });
                
                // Update active state
                navLinks.forEach(link => {
                    link.classList.remove('active');
                });
                
                if (currentSection && currentSection.id) {
                    const correspondingLink = document.querySelector(`.md-nav--secondary .md-nav__link[href="#${currentSection.id}"]`);
                    if (correspondingLink) {
                        correspondingLink.classList.add('active');
                    }
                }
            }, 50);
        });
        
        // Initial highlight for the first section
        if (headings.length > 0 && headings[0].id) {
            const firstLink = document.querySelector(`.md-nav--secondary .md-nav__link[href="#${headings[0].id}"]`);
            if (firstLink) {
                firstLink.classList.add('active');
            }
        }
    }, 500); // Wait 500ms for page to fully load
});
</script>
{% endblock %}
